<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ø¹Ø´Ø§Ø±Ùƒ â€” Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</title>
<style>
:root{--accent:#e91e63;--bg:#fffafc}
body{font-family:tahoma;background:var(--bg);margin:0;color:#222}
.header{background:linear-gradient(90deg,var(--accent),#9c27b0);color:#fff;padding:16px;text-align:center;font-weight:700}
.container{max-width:1100px;margin:18px auto;padding:12px}
.grid{display:grid;grid-template-columns:1fr 380px;gap:16px}
.panel{background:#fff;padding:12px;border-radius:12px;box-shadow:0 8px 26px rgba(0,0,0,0.06)}
input,textarea,select{width:100%;padding:8px;border-radius:8px;border:1px solid #eee;margin-top:8px}
.btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
.btn.ghost{background:#fff;color:var(--accent);border:2px solid var(--accent)}
.store-list{max-height:420px;overflow:auto;margin-top:8px}
.row{display:flex;gap:8px;align-items:center}
.small{font-size:13px;color:#666}
</style>
</head>
<body>
  <div class="header">Ø¹Ø´Ø§Ø±Ùƒ â€” Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
  <div class="container">
    <div style="display:flex;justify-content:space-between;margin-bottom:10px">
      <div><button class="btn" onclick="openPublic()">Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button></div>
      <div style="display:flex;gap:8px">
        <button class="btn ghost" onclick="exportData()">â¬‡ï¸ ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <button class="btn ghost" onclick="importJson()">â¬†ï¸ Ø¥Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <input type="file" id="importFile" accept="application/json" style="display:none" onchange="handleImport(event)">
      </div>
    </div>

    <div class="grid">
      <!-- Ø§Ù„ÙŠØ³Ø§Ø±: Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¬Ø± ÙˆÙ…Ù†ØªØ¬Ø§Øª -->
      <div class="panel">
        <h3>Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¬Ø± Ø¬Ø¯ÙŠØ¯</h3>
        <input id="sName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø± (Ù…Ø«Ø§Ù„: Ù…ØªØ¬Ø± Ø§Ù„ÙˆØ±ÙˆØ¯)"/>
        <input id="sOwner" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ"/>
        <input id="sPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"/>
        <input id="sCategory" placeholder="Ø§Ù„ØªØµÙ†ÙŠÙ (ÙˆØ±Ø¯ / ÙƒØ±Ø²Ø§Øª ...)"/>
        <input id="sImage" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù…ØªØ¬Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"/>
        <textarea id="sDesc" placeholder="Ù†Ø¨Ø°Ø© Ø¹Ù† Ø§Ù„Ù…ØªØ¬Ø± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"></textarea>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" onclick="createStore()">â• Ø¥Ø¶Ø§ÙØ© Ù…ØªØ¬Ø±</button>
          <button class="btn ghost" onclick="clearStoreForm()">Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
        </div>

        <hr style="margin:12px 0"/>

        <h3>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù„Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯</h3>
        <div class="small">Ø§Ø®ØªØ± Ù…ØªØ¬Ø± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙŠÙ…Ù†Ù‰ Ø£ÙˆÙ„Ø§Ù‹</div>
        <select id="selectStore" style="margin-top:8px"></select>
        <input id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"/>
        <input id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø± Ù„ÙƒÙ„ ÙƒÙŠÙ„Ùˆ/Ù‚Ø·Ø¹Ø© (Ø¯.Ø¹)"/>
        <input id="pImage" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"/>
        <label style="display:block;margin-top:8px"><input type="checkbox" id="pNeedScale"/> ÙŠØ­ØªØ§Ø¬ Ù…ÙŠØ²Ø§Ù†</label>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" onclick="addProduct()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
          <button class="btn ghost" onclick="clearProductForm()">Ù…Ø³Ø­</button>
        </div>

        <div style="margin-top:14px">
          <h4>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯</h4>
          <div id="storeProducts" class="store-products small"></div>
        </div>
      </div>

      <!-- Ø§Ù„ÙŠÙ…ÙŠÙ†: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø± ÙˆØ§Ù„Ø£Ø¯ÙˆØ§Øª -->
      <div class="panel">
        <h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ§Ø¬Ø±</h3>
        <input id="filter" placeholder="ÙÙ„ØªØ± Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø§Ù„Ùƒ" oninput="renderStores()"/>
        <div id="storesList" class="store-list"></div>

        <hr style="margin:12px 0"/>
        <div class="small">Ø£Ø¯ÙˆØ§Øª Ø³Ø±ÙŠØ¹Ø©</div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn ghost" onclick="seedDemo()">âš¡ Ø¨ÙŠØ§Ù†Ø§Øª ØªÙˆØ¶ÙŠØ­ÙŠØ©</button>
          <button class="btn ghost" onclick="clearAll()">ğŸ—‘ï¸ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
      </div>
    </div>
  </div>

<script>
/* helpers */
function uid(p='id'){return p+'_'+Date.now()+'_'+Math.floor(Math.random()*900+100)}
function load(k,d){try{return JSON.parse(localStorage.getItem(k))||d}catch(e){return d}}
function save(k,v){localStorage.setItem(k,JSON.stringify(v))}
function openPublic(){window.location.href='index.html'}

/* initial */
let stores = load('stores',[]);
renderStoresList();
populateStoreSelect();

/* store functions */
function createStore(){
  const name=document.getElementById('sName').value.trim();
  if(!name){ alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±'); return; }
  const st = { id: uid('s'), name, owner: document.getElementById('sOwner').value.trim(), phone: document.getElementById('sPhone').value.trim(), category: document.getElementById('sCategory').value.trim() || 'Ø¹Ø§Ù…', image: document.getElementById('sImage').value.trim(), description: document.getElementById('sDesc').value.trim(), products:[] };
  stores.push(st); save('stores',stores); renderStoresList(); populateStoreSelect(); clearStoreForm(); alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø±');
}
function clearStoreForm(){ ['sName','sOwner','sPhone','sCategory','sImage','sDesc'].forEach(id=>document.getElementById(id).value='') }

/* render list */
function renderStoresList(){
  stores = load('stores',[]);
  const filter = (document.getElementById('filter').value||'').toLowerCase();
  const list = document.getElementById('storesList'); list.innerHTML='';
  if(!stores.length){ list.innerHTML='<div class="small">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ØªØ§Ø¬Ø± Ø¨Ø¹Ø¯</div>'; return; }
  stores.filter(s=> !filter || s.name.toLowerCase().includes(filter) || (s.owner||'').toLowerCase().includes(filter)).forEach(s=>{
    const div = document.createElement('div'); div.style.padding='8px'; div.style.borderBottom='1px solid #f4e9f2';
    div.innerHTML = `<strong>${s.name}</strong><div class="small">${s.owner||''} â€¢ ${s.category||''}</div>
      <div style="margin-top:8px;display:flex;gap:8px">
        <button class="btn" onclick="selectStore('${s.id}')">ÙØªØ­</button>
        <button class="btn ghost" onclick="editStore('${s.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
        <button class="btn ghost" onclick="deleteStore('${s.id}')">Ø­Ø°Ù</button>
      </div>`;
    list.appendChild(div);
  });
}

/* select store */
let selectedStoreId = null;
function selectStore(id){
  selectedStoreId = id;
  populateStoreSelect();
  showStoreProducts();
  document.getElementById('selectStore').value = id;
}

/* populate select dropdown */
function populateStoreSelect(){
  const sel = document.getElementById('selectStore'); sel.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù…ØªØ¬Ø±</option>';
  stores.forEach(s=> sel.innerHTML += `<option value="${s.id}">${s.name}</option>`);
}

/* add product */
function addProduct(){
  const sid = document.getElementById('selectStore').value || selectedStoreId;
  if(!sid){ alert('Ø§Ø®ØªØ± Ù…ØªØ¬Ø±Ù‹Ø§ Ø£ÙˆÙ„Ø§Ù‹'); return; }
  const name = document.getElementById('pName').value.trim();
  const price = parseFloat(document.getElementById('pPrice').value);
  if(!name || !price){ alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØ§Ù„Ø³Ø¹Ø±'); return; }
  const img = document.getElementById('pImage').value.trim() || '';
  const needScale = document.getElementById('pNeedScale').checked;
  const st = stores.find(x=>x.id===sid);
  st.products.push({ id: uid('p'), name, price, image: img, needScale });
  save('stores', stores);
  clearProductForm();
  showStoreProducts();
  alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬');
}

/* show products of selected store */
function showStoreProducts(){
  const sid = document.getElementById('selectStore').value || selectedStoreId;
  const box = document.getElementById('storeProducts'); box.innerHTML='';
  if(!sid){ box.innerHTML='<div class="small">Ø§Ø®ØªØ± Ù…ØªØ¬Ø±Ù‹Ø§ Ù„Ø¹Ø±Ø¶ Ù…Ù†ØªØ¬Ø§ØªÙ‡</div>'; return; }
  const st = stores.find(x=>x.id===sid);
  if(!st || !st.products.length){ box.innerHTML='<div class="small">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯</div>'; return; }
  st.products.forEach(p=>{
    const d = document.createElement('div'); d.className='product'; d.innerHTML = `<strong>${p.name}</strong> - ${p.price.toLocaleString()} Ø¯.Ø¹ ${p.needScale? 'âš–ï¸':''} <div style="margin-top:6px"><button class="btn ghost" onclick="removeProduct('${st.id}','${p.id}')">Ø­Ø°Ù</button></div>`;
    box.appendChild(d);
  });
}

function clearProductForm(){ ['pName','pPrice','pImage'].forEach(id=>document.getElementById(id).value=''); document.getElementById('pNeedScale').checked=false }

/* edit/delete */
function editStore(id){
  const st = stores.find(x=>x.id===id);
  if(!st) return;
  document.getElementById('sName').value = st.name; document.getElementById('sOwner').value = st.owner; document.getElementById('sPhone').value = st.phone; document.getElementById('sCategory').value = st.category; document.getElementById('sImage').value = st.image; document.getElementById('sDesc').value = st.description;
  // remove old (simple edit flow)
  stores = stores.filter(x=>x.id!==id); save('stores',stores); renderStoresList();
}

function deleteStore(id){
  if(!confirm('Ø­Ø°Ù Ø§Ù„Ù…ØªØ¬Ø± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ')) return;
  stores = stores.filter(x=>x.id!==id); save('stores',stores); renderStoresList(); populateStoreSelect(); selectedStoreId=null; document.getElementById('storeProducts').innerHTML='';
}

function removeProduct(storeId, prodId){
  const st = stores.find(x=>x.id===storeId);
  st.products = st.products.filter(p=>p.id!==prodId);
  save('stores',stores); showStoreProducts();
}

/* export/import */
function exportData(){
  const data = {stores};
  const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='ashark-data.json'; a.click(); URL.revokeObjectURL(url);
}
function importJson(){ document.getElementById('importFile').click() }
function handleImport(e){
  const f = e.target.files[0]; if(!f) return;
  const r = new FileReader(); r.onload = ()=> {
    try{
      const data = JSON.parse(r.result);
      if(Array.isArray(data.stores)) { stores = data.stores; save('stores',stores); renderStoresList(); populateStoreSelect(); alert('ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯'); }
    }catch(err){ alert('Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­') }
  }; r.readAsText(f);
}

/* seed, clear */
function seedDemo(){
  if(!confirm('Ø¥Ø¶Ø§ÙØ© Ø£Ù…Ø«Ù„Ø©ØŸ')) return;
  const demo = [
    { id: uid('s'), name:'Ù…ØªØ¬Ø± Ø§Ù„ÙƒØ±Ø²Ø§Øª', owner:'Ø£Ø­Ù…Ø¯', phone:'0770000000', category:'ÙƒØ±Ø²Ø§Øª', description:'ÙƒØ±Ø²Ø§Øª Ø·Ø§Ø²Ø¬Ø©', image:'https://cdn.pixabay.com/photo/2016/11/18/16/39/cherries-1835786_1280.jpg', products:[
      {id:uid('p'), name:'ÙƒØ±Ø²Ø§Øª Ù…Ø´ÙƒÙ„Ø©', price:10000, image:'https://cdn.pixabay.com/photo/2016/11/18/16/39/cherries-1835786_1280.jpg', needScale:true}
    ]}
  ];
  stores = stores.concat(demo); save('stores',stores); renderStoresList(); populateStoreSelect();
}
function clearAll(){ if(!confirm('Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) return; localStorage.removeItem('stores'); localStorage.removeItem('cart'); localStorage.removeItem('orders'); stores=[]; renderStoresList(); populateStoreSelect(); alert('ØªÙ… Ø§Ù„Ø­Ø°Ù') }

/* init */
renderStoresList();
populateStoreSelect();
showStoreProducts();
</script>
</body>
</html>
