<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØªØ¬Ø± - ØªØ¬Ø±Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ©</title>
<style>
body {
  font-family: "Tahoma";
  margin: 0;
  background: #fffafc;
  color: #333;
}
.header {
  background: linear-gradient(90deg, #e91e63, #9c27b0);
  color: #fff;
  text-align: center;
  padding: 20px;
  font-size: 22px;
  font-weight: bold;
}
.container {
  max-width: 1100px;
  margin: 20px auto;
  padding: 15px;
}
.store-info {
  background: #fff;
  border-radius: 20px;
  padding: 20px;
  display: flex;
  gap: 20px;
  align-items: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.store-info img {
  width: 220px;
  height: 220px;
  border-radius: 15px;
  object-fit: contain;
  background: #fff;
  border: 2px solid #eee;
  padding: 10px;
}
.store-details h2 { color: #e91e63; margin: 0; }
.products { margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
.product-card {
  background: #fff;
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  text-align: center;
  position: relative;
}
.product-card img {
  width: 100%;
  height: 180px;
  object-fit: contain;
  background: #fff;
  padding: 10px;
}
.product-card div { padding: 10px; }
button {
  background: #e91e63;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 8px 14px;
  cursor: pointer;
  transition: 0.3s;
}
button:hover { background: #c2185b; }
.back-btn { margin-top: 20px; display: inline-block; background: #9c27b0; color: #fff; padding: 8px 16px; border-radius: 10px; text-decoration: none; }
.cart-btn { position: fixed; top: 20px; left: 20px; background: #e91e63; color: #fff; padding: 10px 16px; border-radius: 50px; font-weight: bold; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
.cart-btn:hover { background: #c2185b; }

/* Ù…ÙŠØ²Ø§Ù† ÙˆÙƒÙŠØ³ */
.scale-container {
  margin-top: 10px;
  width: 100%;
  height: 150px;
  border: 2px solid #ccc;
  position: relative;
  border-radius: 10px;
  background: #fdf2f8;
}
.cherry-amount {
  width: 100%;
  position: absolute;
  bottom: 0;
  background: red;
  border-radius: 5px 5px 0 0;
  transition: height 0.3s;
}
.bag-animation {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 50px;
  height: 50px;
  background: url('images/bag.png') no-repeat center/contain;
}
</style>
</head>
<body>

<div class="header">ğŸŒ¸ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© ğŸŒ¸</div>
<div class="cart-btn" onclick="goToCart()">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</div>

<div class="container" id="storeContainer"></div>

<script>
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
const store = JSON.parse(localStorage.getItem('selectedStore') || '{}');
const storeContainer = document.getElementById('storeContainer');
const allProducts = {
  "Ù…ØªØ¬Ø± Ø§Ù„ÙƒØ±Ø²Ø§Øª": [
    {name: "ÙƒØ±Ø²Ø§Øª Ù…Ø´ÙƒÙ„Ø©", type:"kilo", basePrice:10000, image:"images/nuts1.jpg"},
    {name: "ÙØ³ØªÙ‚ ÙØ§Ø®Ø±", type:"kilo", basePrice:12000, image:"images/nuts2.jpg"},
    {name: "Ø¬ÙˆØ² Ù…Ø­Ù…Øµ", type:"kilo", basePrice:8000, image:"images/nuts3.jpg"}
  ]
};

// Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±
if(store && store.name){
  const products = allProducts[store.name] || [];
  storeContainer.innerHTML = `
    <div class="store-info">
      <img src="${store.image}" alt="${store.name}">
      <div class="store-details">
        <h2>${store.name}</h2>
        <p>${store.description}</p>
        <p><strong>Ø§Ù„Ù…Ø§Ù„Ùƒ:</strong> ${store.owner}</p>
        <p><strong>ğŸ“ Ø§Ù„Ù‡Ø§ØªÙ:</strong> ${store.phone}</p>
        <p><strong>Ø§Ù„ØªØµÙ†ÙŠÙ:</strong> ${store.category}</p>
      </div>
    </div>
    <div class="products">
      ${products.map((p,i)=>`
        <div class="product-card">
          <img src="${p.image}" alt="${p.name}">
          <div>
            <h4>${p.name}</h4>
            <p>Ø§Ù„Ø³Ø¹Ø±: ${p.basePrice} Ø¯.Ø¹ / ÙƒÙŠÙ„Ùˆ</p>
            <label>Ø§Ø®ØªØ± Ø§Ù„ÙˆØ²Ù†:</label>
            <select onchange="updateScale(this, ${p.basePrice})">
              <option value="0.25">Ø±Ø¨Ø¹ ÙƒÙŠÙ„Ùˆ</option>
              <option value="0.5">Ù†ØµÙ ÙƒÙŠÙ„Ùˆ</option>
              <option value="1">1 ÙƒÙŠÙ„Ùˆ</option>
            </select>
            <div class="scale-container">
              <div class="cherry-amount"></div>
            </div>
            <button onclick="addToCart(${i})">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
          </div>
        </div>
      `).join('')}
    </div>
    <a href="index.html" class="back-btn">â¬…ï¸ Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ù…ØªØ§Ø¬Ø±</a>
  `;
}else{
  storeContainer.innerHTML = "<p>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±.</p>";
}

// ğŸŒŸ Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ÙŠØ²Ø§Ù† ÙˆØ§Ù„Ø³Ù„Ø©
const scaleDivs = document.querySelectorAll('.cherry-amount');
const weightSelects = document.querySelectorAll('select');

function updateScale(select, price){
  const index = Array.from(weightSelects).indexOf(select);
  const weight = parseFloat(select.value);
  scaleDivs[index].style.height = (weight*150)+'px';
}

function addToCart(productIndex){
  const product = allProducts[store.name][productIndex];
  const weight = parseFloat(weightSelects[productIndex].value);
  const totalPrice = product.basePrice*weight;
  
  let cart = JSON.parse(localStorage.getItem('cart')||'[]');
  cart.push({
    store: store.name,
    name: product.name,
    type: product.type,
    weight: weight,
    price: totalPrice
  });
  localStorage.setItem('cart', JSON.stringify(cart));

  // ØªØ­Ø±ÙŠÙƒ Ø§ÙØªØ±Ø§Ø¶ÙŠ ÙÙŠ Ø§Ù„ÙƒÙŠØ³
  const bag = document.createElement('div');
  bag.className = 'bag-animation';
  document.body.appendChild(bag);
  bag.animate([{transform:'translate(0,0)'},{transform:'translate(-80vw,-80vh)'}],{duration:800});
  setTimeout(()=>bag.remove(),900);

  alert(`âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© ${weight} ÙƒÙŠÙ„Ùˆ Ù…Ù† ${product.name} Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©!`);
}

function goToCart(){ window.location.href = 'cart.html'; }

weightSelects.forEach((s,i)=>updateScale(s, allProducts[store.name][i].basePrice));
</script>

</body>
</html>
