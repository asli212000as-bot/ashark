<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù…ØªØ¬Ø± - Ù…ÙŠØ²Ø§Ù† ØªÙ‚Ù„ÙŠØ¯ÙŠ Ø¨Ø¥Ø¨Ø±Ø©</title>
<style>
  :root{
    --accent:#e91e63;
    --accent-dark:#c2185b;
    --bg:#fffafc;
    --card:#fff;
  }
  *{box-sizing:border-box}
  body{font-family:Tahoma, Arial, sans-serif;margin:0;background:var(--bg);color:#222}
  .header{background:linear-gradient(90deg,var(--accent),#9c27b0);color:#fff;padding:18px 12px;text-align:center;font-size:20px}
  .cart-btn{position:fixed;left:16px;top:16px;background:var(--accent);color:#fff;padding:10px 14px;border-radius:999px;z-index:999;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.12)}
  .container{max-width:1100px;margin:20px auto;padding:12px}
  .store-info{display:flex;gap:16px;align-items:center;background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.06)}
  .store-info img{width:160px;height:120px;object-fit:cover;border-radius:10px}
  .store-details h2{margin:0;color:var(--accent)}
  .products{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin-top:18px}
  .card{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 8px 26px rgba(0,0,0,0.06);text-align:center;position:relative;overflow:visible}
  .card img.prod{width:100%;height:160px;object-fit:cover;border-radius:8px;background:#faf;}
  .card h3{margin:8px 0;color:#333}
  .price{color:var(--accent);font-weight:800;margin-bottom:6px}
  .controls{display:flex;gap:8px;justify-content:center;align-items:center;margin:8px 0}
  select{padding:8px;border-radius:8px;border:1px solid #ddd}
  button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:10px;cursor:pointer}
  button:hover{background:var(--accent-dark)}
  /* Ø§Ù„Ù…ÙŠØ²Ø§Ù† Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ */
  .scale-wrap{display:flex;justify-content:center;margin:8px 0}
  .dial{
    width:150px;height:150px;border-radius:50%;background:linear-gradient(180deg,#fff,#fff0);
    box-shadow: inset 0 4px 10px rgba(0,0,0,0.05);
    position:relative;display:flex;align-items:center;justify-content:center;
    border:6px solid #faf0f4;
  }
  /* Ø¹Ù„Ø§Ù…Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ© */
  .dial:before{
    content:"";position:absolute;inset:-6px;border-radius:50%;
    background:conic-gradient(from 200deg at 50% 50%, rgba(0,0,0,0.03), transparent 10deg);
    mask:radial-gradient(farthest-side, transparent 70%, black 72%);
    opacity:0.06;
  }
  .needle{
    width:4px;height:64px;background:#333;border-radius:4px;
    position:absolute;bottom:50%;transform-origin:50% 100%;transform:rotate(-45deg);
    transition:transform 450ms cubic-bezier(.2,.9,.3,1);
    box-shadow:0 2px 8px rgba(0,0,0,0.25);
  }
  .needle::after{
    content:"";position:absolute;left:50%;transform:translateX(-50%);bottom:-12px;width:18px;height:18px;border-radius:50%;background:var(--accent);box-shadow:0 2px 6px rgba(0,0,0,0.2)
  }
  .dial .center-dot{width:12px;height:12px;border-radius:50%;background:#222;position:absolute}
  .dial .markings{position:absolute;inset:0;pointer-events:none}
  .dial .mark{position:absolute;left:50%;transform-origin:0 0;width:6px;height:14px;background:#888;top:8px;transform:translateX(-50%) rotate(0deg);opacity:0.9}
  /* Ù†Øµ Ø§Ù„ÙˆØ²Ù† */
  .weight-label{font-weight:700;color:#444;margin-top:6px}
  /* Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø·Ø§Ø¦Ø± */
  .fly{position:absolute;border-radius:50%;z-index:9999;pointer-events:none;opacity:1;transition:all 0.8s cubic-bezier(.2,.9,.3,1)}
  /* responsive */
  @media(max-width:700px){ .store-info{flex-direction:column;align-items:flex-start} .store-info img{width:100%;height:140px} }
</style>
</head>
<body>
  <div class="header">ğŸŒ¸ Ù…ØªØ¬Ø± - Ù…ÙŠØ²Ø§Ù† ØªÙ‚Ù„ÙŠØ¯ÙŠ Ø¨Ø¥Ø¨Ø±Ø© ØªÙØ§Ø¹Ù„ÙŠØ©</div>
  <div class="cart-btn" id="cartBtn">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</div>

  <div class="container">
    <div class="store-info">
      <img src="https://cdn.pixabay.com/photo/2016/02/19/11/19/roses-1209504_1280.jpg" alt="Ù…ØªØ¬Ø±">
      <div class="store-details">
        <h2>Ù…ØªØ¬Ø± Ø§Ù„ÙƒØ±Ø²Ø§Øª ÙˆØ§Ù„ÙˆØ±Ø¯</h2>
        <p class="muted">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø·Ø§Ø²Ø¬Ø© â€” Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…ØªØ¬Ø±: Ù…Ù‡Ø¯ÙŠ</p>
        <p>ğŸ“ 07700000000</p>
      </div>
    </div>

    <div class="products" id="productsGrid"></div>
  </div>

<script>
/* ===== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª (Ù…Ù…ÙƒÙ† ØªØ­Ù„ Ù…Ø­Ù„Ù‡Ø§ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† admin Ù„Ø§Ø­Ù‚Ø§Ù‹) ===== */
const products = [
  { id:'p1', name:'ÙƒØ±Ø²Ø§Øª Ù…Ø´ÙƒÙ„Ø©', base:10000, img:'https://cdn.pixabay.com/photo/2016/11/18/16/39/cherries-1835786_1280.jpg', type:'kilo' },
  { id:'p2', name:'Ø¨Ø§Ù‚Ø© ÙˆØ±Ø¯ Ø£Ø­Ù…Ø±', base:5000, img:'https://cdn.pixabay.com/photo/2018/01/15/07/51/rose-3087424_1280.jpg', type:'kilo' },
  { id:'p3', name:'ÙØ³ØªÙ‚ ÙØ§Ø®Ø±', base:12000, img:'https://cdn.pixabay.com/photo/2017/08/07/12/57/pistachios-2601749_1280.jpg', type:'kilo' }
];

/* render Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
const grid = document.getElementById('productsGrid');
products.forEach((p, idx)=>{
  const card = document.createElement('div'); card.className='card';
  card.innerHTML = `
    <img class="prod" src="${p.img}" alt="${p.name}">
    <h3>${p.name}</h3>
    <div class="price">${p.base.toLocaleString()} Ø¯.Ø¹ / ÙƒÙŠÙ„Ùˆ</div>
    <div class="controls">
      <label for="sel${idx}">Ø§Ø®ØªØ± Ø§Ù„ÙˆØ²Ù†</label>
      <select id="sel${idx}" data-idx="${idx}">
        <option value="0.25">Ø±Ø¨Ø¹ ÙƒÙŠÙ„Ùˆ</option>
        <option value="0.5">Ù†ØµÙ ÙƒÙŠÙ„Ùˆ</option>
        <option value="1">1 ÙƒÙŠÙ„Ùˆ</option>
      </select>
    </div>

    <div class="scale-wrap" style="margin-top:10px; display:flex;justify-content:center">
      <div class="dial" id="dial${idx}">
        <div class="markings" id="marks${idx}"></div>
        <div class="needle" id="needle${idx}"></div>
        <div class="center-dot"></div>
      </div>
    </div>
    <div class="weight-label" id="label${idx}">Ø§Ù„ÙˆØ²Ù†: Ø±Ø¨Ø¹ ÙƒÙŠÙ„Ùˆ</div>

    <div style="margin-top:8px">
      <button id="btn${idx}">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
    </div>
  `;
  grid.appendChild(card);
});

/* Ø±Ø³Ù… Ø¹Ù„Ø§Ù…Ø§Øª Ø¨Ø³ÙŠØ·Ø© Ø­ÙˆÙ„ Ø§Ù„Ù‚Ø±Øµ (ØªØ¬Ù…ÙŠÙ„) */
function createMarks(){
  products.forEach((_,i)=>{
    const marks = document.getElementById('marks'+i);
    if(!marks) return;
    marks.innerHTML = '';
    // Ù†Ø¶Ø¹ Ø¹Ù„Ø§Ù…Ø§Øª Ù…Ù† -45deg Ø¥Ù„Ù‰ +45deg (Ø£ÙŠ Ù…Ù‚ÙŠØ§Ø³ 90Ø¯Ø±Ø¬Ø©)
    const steps = 9;
    for(let s=0;s<=steps;s++){
      const el = document.createElement('div');
      el.className = 'mark';
      const angle = -45 + (90 * (s/steps)); // degrees
      el.style.transform = `translateX(-50%) rotate(${angle}deg) translateY(-60px)`;
      el.style.height = s%2===0?'18px':'10px';
      marks.appendChild(el);
    }
  });
}
createMarks();

/* WebAudio: ØµÙˆØª Ø®ÙÙŠÙ Ø¹Ù†Ø¯ ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¥Ø¨Ø±Ø© */
const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
function tickSound(){
  try{
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = 'sine';
    o.frequency.value = 800;
    g.gain.value = 0.02;
    o.connect(g); g.connect(audioCtx.destination);
    o.start();
    setTimeout(()=>{ o.stop(); }, 80);
  }catch(e){ /* Ø¨Ø¹Ø¶ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª ØªÙ…Ù†Ø¹ Autoplay Ù‚Ø¨Ù„ ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */ }
}

/* Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­Ø±ÙƒØ©: Ù†Ø­Ø±Ùƒ Ø§Ù„Ø¥Ø¨Ø±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙˆØ²Ù† */
function weightToAngle(weight){
  // mapping: 0 -> -45deg, 1kg -> +45deg
  return -45 + (weight * 90);
}

/* ØªÙ‡ÙŠØ¦Ø© event listeners */
products.forEach((p, i)=>{
  const sel = document.getElementById('sel'+i);
  const needle = document.getElementById('needle'+i);
  const label = document.getElementById('label'+i);
  const btn = document.getElementById('btn'+i);

  // set initial angle for default value
  const initW = parseFloat(sel.value);
  needle.style.transform = `rotate(${weightToAngle(initW)}deg)`;
  label.textContent = `Ø§Ù„ÙˆØ²Ù†: ${(initW===1? '1 ÙƒÙŠÙ„Ùˆ' : (initW===0.5? 'Ù†ØµÙ ÙƒÙŠÙ„Ùˆ':'Ø±Ø¨Ø¹ ÙƒÙŠÙ„Ùˆ'))}`;

  sel.addEventListener('change', ()=>{
    const w = parseFloat(sel.value);
    const ang = weightToAngle(w);
    needle.style.transform = `rotate(${ang}deg)`;
    label.textContent = `Ø§Ù„ÙˆØ²Ù†: ${(w===1? '1 ÙƒÙŠÙ„Ùˆ' : (w===0.5? 'Ù†ØµÙ ÙƒÙŠÙ„Ùˆ':'Ø±Ø¨Ø¹ ÙƒÙŠÙ„Ùˆ'))}`;
    tickSound();
  });

  btn.addEventListener('click', (ev)=>{
    // Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ·: Ù†Ø¹Ù…Ù„ Ø­Ø±ÙƒØ© Ù…Ø±Ø¦ÙŠØ© Ø«Ù… Ù†Ø­ÙØ¸ ÙÙŠ cart
    const w = parseFloat(sel.value);
    const total = Math.round(p.base * w);
    animateToCart(ev.target, w);
    // Ø­ÙØ¸ ÙÙŠ localStorage
    const orders = JSON.parse(localStorage.getItem('cart')||'[]');
    orders.push({ productId:p.id, name:p.name, weight:w, price:total, store:'Ù…ØªØ¬Ø±Ùƒ' });
    localStorage.setItem('cart', JSON.stringify(orders));
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù‚ØµÙŠØ±Ø© Ø¨Ø¹Ø¯ Ù‚Ù„ÙŠÙ„
    setTimeout(()=>alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© ${w} ÙƒØº Ù…Ù† ${p.name} â€” Ø§Ù„Ø³Ø¹Ø±: ${total.toLocaleString()} Ø¯.Ø¹`), 900);
  });
});

/* Ø­Ø±ÙƒØ© Ø§Ù„Ø¹Ù†ØµØ± Ù„Ù„Ø·ÙŠØ±Ø§Ù† Ù†Ø­Ùˆ Ø§Ù„Ø³Ù„Ø© */
function animateToCart(button, weight){
  const rect = button.getBoundingClientRect();
  const cart = document.getElementById('cartBtn').getBoundingClientRect();
  const fly = document.createElement('div');
  fly.className = 'fly';
  // Ø­Ø¬Ù… ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„ÙˆØ²Ù†
  const size = 28 + (weight*36);
  fly.style.width = size + 'px';
  fly.style.height = size + 'px';
  fly.style.left = (rect.left + rect.width/2 - size/2) + 'px';
  fly.style.top = (rect.top + rect.height/2 - size/2) + 'px';
  fly.style.background = 'radial-gradient(circle at 35% 30%, #fff6, #f06292)';
  document.body.appendChild(fly);

  // ØªØ­Ø±ÙŠÙƒ
  requestAnimationFrame(()=>{
    fly.style.left = (cart.left + cart.width/2 - size/4) + 'px';
    fly.style.top = (cart.top + cart.height/2 - size/4) + 'px';
    fly.style.transform = 'scale(0.4)';
    fly.style.opacity = '0.6';
  });
  setTimeout(()=>fly.remove(), 900);
}

/* Ø³Ù„ÙˆÙƒ Ø²Ø± Ø§Ù„Ø³Ù„Ø© */
document.getElementById('cartBtn').addEventListener('click', ()=>{
  // Ø§ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø© Ø£Ùˆ Ø¹Ø±Ø¶ Ù…Ø®ØªØµØ±
  const cart = JSON.parse(localStorage.getItem('cart')||'[]');
  if(!cart.length){ alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©'); return; }
  // Ù†Ø¹Ø±Ø¶ Ù†Ø¸Ø±Ø© Ø³Ø±ÙŠØ¹Ø© Ø«Ù… Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ cart.html Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯Ø©
  let summ = 'Ù…Ù„Ø®Øµ Ø§Ù„Ø³Ù„Ø©:\\n';
  let total=0;
  cart.forEach((it,idx)=>{ summ += `${idx+1}. ${it.name} - ${it.weight} ÙƒØº - ${it.price.toLocaleString()} Ø¯.Ø¹\\n`; total+=it.price; });
  summ += `Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${total.toLocaleString()} Ø¯.Ø¹`;
  if(confirm(summ + '\\n\\nÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø©ØŸ')) { window.location.href='cart.html'; }
});
</script>
</body>
</html>
